---
title: "chapter_1 データを見る"
author: "Toshiki SHIBANO"
date: "2/3/2021"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## まえがき
本章はデータの可視化の良し悪しが生じる理由について述べる

**データを見せる相手によって図の見せ方は変わる**ので簡単に良いグラフを決めれない

本章ではデータの構造とグラフの知覚的特徴の関係について考えることから始める

グラフを書く際は，ソフトウェアに頼るのではなく，良いグラフに対する自分自身の感性を磨き上げる必要がある

本章は

1. データをなぜグラフにするのか
2. 良いグラフと悪いグラフを比較して一般的なルールの有用性とその限界について述べる
3. ミスリードしてしまう可能性のあるグラフについて
4. 色・形・オブジェクトの関連性を人はどう知覚し，認知するのか

まえがきを簡単にまとめると

優れた可視化は，私たちがデータを探索・理解・説明するための非常に強力なツールとなるが
人々だけでなく，自分も騙してしまうことになる




## 1.1 なぜデータを見るのか
アンスコムの四重奏(Amscombe's quartet): 
いずれも相関係数が0.82だが，散布図(scatter plot)を書くことで違いがわかる
```{r Amscombe, results='asis'}
# anscombe data
knitr::kable(anscombe, format = "pandoc")
c1 <- cor(anscombe$x1, anscombe$y1)
c2 <- cor(anscombe$x2, anscombe$y2)
c3 <- cor(anscombe$x3, anscombe$y3)
c4 <- cor(anscombe$x4, anscombe$y4)
cor.data <- data.frame("pair" = c("1", "2", "3", "4"),
                       "correlation" = c(c1, c2, c3, c4))
knitr::kable(cor.data, format = "pandoc")

par(mfrow = c(2, 2))
plot(anscombe$x1, anscombe$y1, xlab = "x1", ylab = "y1")
plot(anscombe$x2, anscombe$y2, xlab = "x2", ylab = "y2")
plot(anscombe$x3, anscombe$y3, xlab = "x3", ylab = "y3")
plot(anscombe$x4, anscombe$y4, xlab = "x4", ylab = "y4")
```


しかしながら，全て可視化するのが良いわけではない．
(大量のデータ点がある場合などは要約統計量やモデル推定なども重要)

**自動的な操作でデータを視覚的に表し，それを眺めるだけで知りたい正しい情報が得られると思ってはいけない**

参考までに

Yan Vanhove(2016)では，データとモデルを図示する利点を表した散布図を発表している



## 1.2 悪いグラフのどこが悪いのか
悪い原因を3つの要点に絞る

1. 審美的要素(aesthetic): センス
2. 本質的(substantive)な問題: グラフから新たな情報が得られるか
3. 知覚(perceptual)の問題: 誤解や混乱が生じる可能性がある

### 1.2.1 センスの問題
エドワード・タフト(Edwaed R. Tufte): 可視化に関する著名な評論家

- 構成とデザインを適切に選ぶこと
- 言葉や数字を一緒に書き込むこと
- 複雑な詳細情報を理解しやすい形で見せること
- 不要な装飾を避けること

すなわち**データ/インク比を最大化する**(可能な限り簡潔にする)

しかしながら，Simple is bestではない．

- 怪物的なコスト(Monstrous Costs): ただの棒グラフよりも読み手の記憶に残る
- ナポレオンの撤退(): 6個の変量が取り込まれた1枚の図

と言ってもこれらは統計的なグラフとは大きく異なる


### 1.2.2 データの問題
ハロー効果(halo effect): よく構成されたデザインがもたらす効果に引っ張られて，図の内容をよりとく解釈してしまう認知バイアス．

得られたデータの扱い方によって結果の解釈が変わることがある

### 1.2.3  知覚の問題
データの可視化は，色や形状や線の数によって符号化(encode)される．つまり図の解釈のプロセスは，形状の幾何学的特徴やその一般的な関係性の認識方法に強く依存している．

余計な次元を加えない(3Dplotはクソ)

積み上げ棒グラフ(stacked bar chart) は合計量とベースラインに近いものの変動は分かるが，それ以外の区分は比較しにくい

図のアスペクト比も影響を及ぼす



## 1.3 知覚とデータ可視化
人の物の見方について


### 1.3.1 エッジ・コントラスト・色
図を見るということは，点や線，色を見ていること．人の視覚システムはあるタスクについては上手くできており，苦手なタスクについては余計なコストがかかる

錯覚

- ヘルマン格子効果
- マッハバンド
- チェッカーシャドウ効果

色の見方

絶対値よりも相対値が重要

RではSequential terrainやDiverging, Unordered huesなどを使って，輝度・彩度・色相の全ての振れ幅が均一に感じられるようにする．

色に配慮する．ggplotなら人の色覚認知における不均一や非線形性を考慮した様々な色空間が定義され標準化されている．


### 1.3.2 前注意探索と「ポップアウト効果」

目立つのは 色チャネル > 形状チャネル．
グラフにチャネル要素を加えれば加えるほど人に負荷がかかる


### 1.3.3 ゲシュタルトの法則

人は常に構造を探す(これこそが，統計的モデリングだけでなくデータの可視化が重要な理由)

ゲシュタルトの法則(gestalt rules): 比較的まばらな視覚的情報に基づいて，その要素感の関係性を強力に推論する．

- 近接性: 空間的に近いものは互いに関連していると見なす
- 類似性: 見た目が似ているものは関連している見なす
- 接続性: 視覚的に結びつけられているもの同士は関係をもつ
- 連続性: 一部が隠されているオブジェクトは親和性のある形に補完される
- 閉鎖性: 不完全な形は完全なものとして知覚される
- 図と背景: 視覚的要素は前景か背景のどちらかに属していると見なす
- 共通の運命: 同じ方向に移動するオブジェクトは1つの群として認識される


(芝野の意見)

このあたりの内容は「Google流資料作成術」も良さそう



## 1.4 視覚的タスクとグラフの逆符号化
逆符号化(decode): 符号化(encode)されたグラフに書いてあるデータを読み取ること

グラフには良し悪しがあって，逆符号化の際にエラーが起きやすくなるグラフは避けるべき．長さ > 角度 > 面積(こっちがよくない)．*3Dはクソ．実は勾配の変化も判断しにくい(アスペクト比に左右されることからも)．



## 1.5 データ表現のための表象の種類と形式
グラフ化に際，正しい方法で変数を符号化したりマッピングしたりする

1. 表現したいデータによって，チャネルやマッピングを選ぶ

- 順序なしカテゴリ変数→グラデーションは無意味
- 連続変数→複数の形状は無意味

2. その表現がどの程度効果的か

- 同じスケール上で位置関係が異なるのが一番比較しやすい
- 3Dは分かりにくい

3. グラフィックスの有効性を考える

- 適した色相を選ぶ

しかしながら，これら自体がグラフの種類を表しているわけではなく，そのタイプのグラフを作るかは別問題



## 1.6 誠実さと適切な判断に関する問題

軸をどこまで載せるのか．0を含めるのか含めないのか．作為的なグラフを作らないように騙されないように．軸ラベルは必ず見る．

```{r}
ti <- c(1, 2, 3)
x <- c(100, 95, 70)
par(mfrow = c(1, 2))
plot(ti, x, ylim = c(0, 100), type = "l", xlab = "")
plot(ti, x, ylim = c(70, 100), type = "l", xlab = "")

```

## 1.7 グラフに関する明確な思考
ggplotの強みは，書き手が作りたいグラフの様々な要素を整理してグラフィックスの文法として実装している点．グラフを作るという巨大なタスクを分化して個別のタスクとして行う．

## 1.8 次の一手
- 視覚的効果
- 知覚認知とデータ可視化の関係性
について参考文献を読むのも良い