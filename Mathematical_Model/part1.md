# 第一部 数理モデルとは
## 第1章 データ分析と数理モデル
### 1.1 データを分析するということ
#### 人間の認知限界とデータ分析
データ分析とは・・・  
対象から情報を取得して，それを分析することで，対象がどのようなメカニズムで動いているのかを客観的に理解すること

#### 対象をデータ生成システムとして捉える
- システム(system): データ分析の対象となるもの
- 観測(observation): 人間がシステムからデータを得ること
- 生成(generate): システムがデータを出すこと
システムから生成されるデータを観測し，その生成ルールを推測する

#### データ分析における限界
データ分析をすれば何でも分かるわけではない．
得られるデータはシステムの一部の状況を反映したものにすぎない．
データ分析を妨げる要因  
- データが足りない
- システムの一部分しか観測できない
- システムの現象が極めて複雑

#### 2つのアプローチ
- 要素還元論的アプローチ
    - システムを分解し，少ない種類の要素の集まりとして理解する
- 新しいアプローチ
    - 要素分解しないアプローチ．
    - 複雑なものは複雑なまま分析する．深層学習などのデータ駆動型(data-driven)の分析パラダイム


---
### 1.2 数理モデルの役割
#### データを眺める以上の分析が必要なら数理モデルの出番
記述統計量(descriptive statistics)や可視化も大事．しかしながら，それだけでは出来ないこともある．

- 現象のメカニズムを客観的な方法で明らかにする
- データから未来を予測する
- コンピュータに高度なデータ処理・データ生成をやらせる

これらを解決するために，数理モデル(mathematical model)を用いる． データを眺める以上の分析が必要なら数理モデルの出番
記述統計量(descriptive statistics)や可視化も大事．しかしながら，それだけでは出来ないこともある．

- 現象のメカニズムを客観的な方法で明らかにする
- データから未来を予測する
- コンピュータに高度なデータ処理・データ生成をやらせる

これらを解決するために，数理モデル(mathematical model)を用いる．  
数理モデル: 数学な手段を用いて記述された，対象のデータ生成ルールを模したもの．  
実際の分析対象を操作することはできないので，数理モデルを介して現象の理解を行う．

#### 数理モデルは「仮定」である

数理モデルによって得られた結論は，常に**使用したモデルという仮定の下**で，という条件付きになっている．

---

### 第1章のまとめ

- 数理モデルとは，数学的な手段を用いて記述された，**対象のデータ生成のルールを模した**もの
- データを眺めただけでは分からない**メカニズムの理解や，予測などの高度な分析・応用**が必要な時に数理モデルが活躍する
- 数理モデルによる分析は，モデルごとに**数理的な「仮定」を前提としている**ことに注意


---

## 第2章 数理モデルの構成要素・種類
### 2.1 変数・数理構造・パラメータ
#### 数理モデルを構成する要素

- 変数(variavle)
- 数理構造(mathematical structure)
- パラメータ(parameter)

#### まずは変数で表すことから

変数: システムの何らかの状態，性質，量などを数字やラベルで表したもの

量的変数と質的変数: 値の性質による分類

- 量的変数(quantitative variable): 足し算，引き算が出来る．身長，気温
    - 間隔尺度: 目盛りが等間隔になっているもの
    - 比例尺度: 原点があり，割り算も意味がある．身長
- 質的変数(qualitative variable): カテゴリ変数(categorical variable)．性別，順位．
    - 名義尺度: 他と分類できるもの．性別
    - 順序尺度: 順序に意味があるが，間隔には意味がない．順位

観測変数と潜在変数: 観測できるか否か

- 観測変数(observable variavle): 直接取得できるデータ．顧客の購入数．
- 潜在変数(latent variable): 取得できないデータ．購入理由

目的変数と説明変数: 説明するかされるか

- 目的変数(objective variable), 従属変数(dependent variavle): 計算される変数
- 説明変数(explanatory varibale), 独立変数(independent variabele): 計算に使う変数

#### 数理構造=「数理モデルの骨組み」

数理モデル: 着目する変数の間の関係性を，数学的に表現したもの．
適切な数理モデルを選ぶことが良い分析の要になる．

#### パラメータは数理モデルを「動かす」

パラメータ: 数理モデルをデータに合わせるための可動域を制御する．
パラメータの数が多くなると表現力が増すが，取り扱いが難しくなる．  
フィッティング:  数理モデルをデータに合わせること

例．体重と身長の線形回帰モデル
$$
W = aH + b
$$
において，全体を数理構造，特にa, bをパラメータと呼ぶ．

---
### 2.2 数理モデルと自然科学の基礎理論
#### 確立した数理モデルは基礎理論に

- ニュートンの運動方程式
$
m\frac{d^2r}{dt^2} = F
$

微分は何かの，何かに対する変化の割合を計算したものであり，非常に重要である．


#### 境界条件と計算の難易度

境界条件(boundary condition): 数理モデルを適用できる範囲．現実問題では取り扱いが難しい

---
### 2.3 理解志向型モデリングと応用志向型モデリン 'Source Han Code JPv
#### 目的によってモデリングは大きく異なる
理解志向型モデリング: データの生成メカニズムを理解する．  
どの要因が強く影響しているのか，なぜそのような現象がおこるのか

応用志向型モデリング: 手元にあるデータを元に未知のデータに対して予測・制御を行なったり，新しいデータを生成して利用する．
現象の理解よりも応用に実装した時の性能を重視する
ex.) 画像の判別，機械翻訳など．

#### モデルの複雑さと理解のしやすさ
モデルの複雑さ: 変数やパラメータの数が多い，数理構造に使われる関数が複雑．


---
### 2.4 理解志向型モデリング
#### 理解志向型モデリングの方法
基本的な考え方: データをうまく説明する数理モデルはデータの生成過程を捉えているからその数理モデルを調べることで理解につながる．大きな方針としては

- 数理構造から説明する方法
- 推定したパラメータの値から説明する方法
- 推定された潜在変数や内部表現を使って次の解析を行う方法
- 数理モデルのパラメータを変化させた状況をシミュレーションする方法

#### 数理構造から説明する方法
モデルがデータを説明できるなら，数理モデルを作る時に仮定した数理構造が正しかったという考え．  
ex)自然渋滞をモデル化した場合．

現象が説明されたとしても，モデルを構成する全ての要素が正しいわけではない．
仮定して良さそうな経験や観測事実からボトムアップ的に論理を構成する

#### 推定したパラメータの値から説明する方法
パラメータの係数から減少を説明する．
ただし，その情報量は数理モデルの質による

#### 推定された潜在変数や内部表現を使って次の解析を行う方法
多次元データを，一度潜在変数を持つ数理モデルで表現し，その潜在変数を使って低次元の表現に変換する．
人間の理解しづらい部分を数理構造でまとめるため，理解しやすくなる．

混合分布モデル(mixture model)や状態空間モデル(state space model)など．
ex) 脳活動の例．複数の領域を混合分布モデルを用いてそれぞれの潜在変数に割り当てることで，低次元データに変換する

#### 数理モデルのパラメータを変化させた状況をシミュレーションする
仮想的に色々な値を入れて振る舞いをシミュレーションすることで，対象の理解を深める．

ex) セルラーゼがセルロースを分解するモデルを組み立て，変数を変化させることで分解速度低下の原因を探る

---
### 2.5 応用志向型モデリング
#### 数理モデルのデータ生成能力を活用する
- 予測(predict): 数理モデルを作った時に使ったデータと異なるデータを入れて，予測する．
- 生成(generation): 数理モデルを作った時に使用したのと同じようなデータを出力すること．
    - 出力: 変数の一部を出力変数として，人間が取り出すこと．
    - 入力: 入力変数として人間が指定すること

#### 予測モデルの例1: 値の予測(回帰)
回帰(regression): 値を予測すること
データによくあったモデルは予測することができる．

- 内挿(interpolation): 観測データの間にある値を予測すること
- 外挿(extrapolation): データが存在していない領域について予測すること．精度が悪くなったり，正しく認識できないことがある．

#### 予測モデルの例2: 分類問題
分類(classification): ラベルやグループに分ける．

- 教師あり学習(supervised learning): ラベルがわかっている場合．
- 教師なし学習(unsupervised learning): ラベルが潜在変数となっている場合．にているデータをまとめる．クラスタリング．

#### 生成モデルを使った応用
生成モデルは学習データがどのように生成されているかそのものを学習する．
敵対的生成ネットワーク(generative adversarial networl: GAN)など．

---
### 2.6 数理モデルの限界と適用範囲
#### 「正しい」数理モデル?
数理モデルは万能ではない．あくまでも現象の近似であり，扱うのに都合が良いからであって正しいわけではない．
数理モデルを作るだけでなく，そのモデルを使って何をしたいかまで考える．

ピグマリオン症: 数理モデルと現実を混同すること．
個人的には数理モデルは仮想世界であり，実データもバイアスがかかったものでそれが全てを表しているわけではないということを留めておく必要があると思う．

#### 良い数理モデルも，いつも正しいとは限らない
データをよく記述する数理モデルを使って分析・応用する際には，「データが得られた時の状況と，説明しようとしている状況が同じ」という仮定がある．
用いたデータの範囲外にある時は，モデルの精度は保証されない．
モデルの適用範囲やリスクに対する頑強性について正しく評価を行う必要がある．

ex) 未曾有の大災害や異常気象など．

---
### 第2章のまとめ
- 数理モデルとは，注目する量を表した変数たちの関係性を数理的に表したもの
- 変数間の関係性は，モデルの骨組みである数理構造とその可動域を決めるパラメータで決まる
- 数理モデルは，目的に応じて理解志向型モデリングや応用志向型モデリングに分けられる
- **数理モデルは万能ではない．目的や適用範囲を謝ると，役に立たず，誤った結論を導く可能性もある**

