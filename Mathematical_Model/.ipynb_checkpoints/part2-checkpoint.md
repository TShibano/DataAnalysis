# 第二部 基礎的な数理モデル
## 第3章 少数の方程式によるモデル
### 3.1 線形モデル

#### 変数間の関係を等式で表現する
数学的に扱いやすく，変数同士の関係や影響の度合いを分析することが可能

#### 線形モデル
線形モデル(linear model): 線型結合(加減・定数倍)で表すことができるモデル．

### 線形モデルを求めるには
パラメータの値をデータに最も当てはまるようにしたい

### 最小二乗法
最小二乗法(least squares method): 二乗誤差を最小にするパラメータを推定する．
詳細な計算は省くが，偏微分することで求まる．

多重共線性: 説明変数にうち，お互いに関与しあっていること．どっちのパラメータを重視して良いか分からなくなり，結果が不安定になる．


---
### 3.2 実験式・カーブフィッティング
#### BMIと数理モデル
$$
    体重[kg] = (定数) \times 身長^2 [m^2]
$$

#### 冪乗による特徴づけ
冪乗則(power law), スケーリング(scaling): ある変数の値が別の変数の値の何乗かに比例する．
この指数を決めているメカニズムを知ることで，本質的なことがわかる場合がある

### 対数プロットで冪乗則を探す
$$
    Y = cX^\alpha \\
    log{Y} = \alpha log{X} + log{a}
$$
対数グラフの傾きを見ることで，$\alpha$を決めることができる．
しかしあんがら，データの和也変数の範囲が不十分だと誤った結果を導くことが多い

### 実験式
実験式(experimental formula): データの振る舞いに合わせて，関数を設定する．
データの可視化を通して組み立て，データと式の誤差からパラメータを計算する．
これには多項式や指数関数，三角関数などが用いられることが多い．


### 3.3 最適化問題
#### 目的の量をコントロールする
最適化問題(optimization problem): 変数を適切に設定して，ある量を最小化・最大化すること．

目的関数(objective function): 最適化問題を行う関数．

#### 大域的最適と局所的最適
局所的最適解(local optimal solution): 周囲よりも小さい・大きい点．

大域的最適解(global optimal solution): 全体で最も小さい・大きい点．

最適化問題が難しくなると，大域最適解を求めるのは難しくなる．様々なアルゴリズムが開発され，計算されている．

#### パラメータ調整も最適化
数理モデルのパラメータを設定するのは，データとモデルの間の誤差を目的関数として最小化するという最適化問題．最適化問題

#### 最適化を難しくする要素
- 変数の制約条件が多い
- 変数が離散的
- グラフやネットワークに関する最適化が含まれている
- 組合せに関する問題が含まれている(組合せ最適化問題)
- 変数の数や，離散変数のとりうる値の場合の数が多い
- 問題に微分不可能な関数や不連続な関数が含まれている

これらの要因により，以下の次のような状況が発生し，困難になる．

- 探索空間が膨大になる
- 微分や変数を少しずつ変化させて解を探す方法が使えないので，解の候補を探すのが大変になる
- 大域的最適解と比べて良くない局所解がたくさんある

---
### 第3章のまとめ
- 変数間の関係性を，変数の定数倍とそれらの加減で記述したモデルを線形モデルという．
- 変数の間の関係性が冪乗で表されるとき，それを冪乗則という．
- モデルの式から予測される値と実際の値の差を二乗して平均をとったものを平均二乗誤差といい，これを最小化することでパラメータの値を決めることを最小二乗法という．
- 変数の値をコントロールして別のある変数の値を最小化・最大化する問題を，最適化問題という．

---
---
## 第4章 少数の微分方程式によるモデル
### 4.1 解ける微分方程式モデル
#### 微分方程式で時間変化を表す
対象の時間変化をボトムアップ的にモデル化したい→微分方程式によるモデリング．  
微分方程式によるモデリングは，家庭から演繹的にモデルを構成することが多い．

力学系(dynamical system): 変数の時間変化を直接記述したモデル

#### マルサスによる個体数モデル
個体数がどのように増えるかをモデル化した．
個体数を$N$，時間を表す変数を$t$とした時，個体が増える速さは$\frac{dN}{dt}$と，$N$の微分で表すことができる．
マルサスは『人口論』において，「この速度はその時点の個体数に比例する」と考えて，
$$
    \frac{dN}{dt} = rN
$$
を，個体数の増加モデルを作成した．$r$は個体が増殖する速さを表すパラメータである．

#### マルサスモデルの解の振る舞い
マルサスモデルを解くと，その解は
$$
    N(t) = N_{0} e^{rt}
$$
と求めることができる．$N_{0}$は最初の時点における個体数．
グラフを書くと分かるが，個体数は時間と共に爆発することがわかる．

#### 個体数は，爆発的に増え続けたりしない
実際には個体数は増え続けない→モデル化が間違っている．
資源は有限なので，個体数が増えすぎた場合は，個体数が減る方向に動くはず．
この効果を含めたのが**ロジスティック回帰(logistic regression)**である．
個体数増加の速度が．個体数によって変動することを加えた，以下のようなモデルである．
$$
    \frac{dN}{dt} = r(1 - \frac{N}{K})N
$$
ここで，$K$は環境収容力というパラメータ．この微分方程式を解くと，
$$
    N(t) = \frac{N_{0}Ke^{rt}}{K - N_{0} + N_{0}e^{rt}}
$$
と求まり，これをロジスティック関数(logistic function)という．

このようにして，生物の個体数変動をボトムアップ的に仮定した方程式によってモデル化することが出来た．
実際に，いくつかの生物種ではこのモデルに合致することが知られている．

#### 簡単な連立微分方程式
一般的に変数が増えると，微分方程式を解くのは非常に難しくなる．
しかし，連立微分方程式なら，変数が増えても解ける場合がある．


#### 2本の連立微分方程式
二つの変数$x_{1}, x_{2}$を用いて以下の連立微分方程式を立てると，
$$
    \frac{dx_{1}}{dt} = -x_{1} + 4x_{2} \\
    \frac{dx_{2}}{dt} = -3x_{1} + 6x_{2}
$$
これは$x_{1}, x_{2}$の時間変化は，現在の$x_{1}$の値(ブレーキのような役割)と$x_{2}$の値(アクセルのような役割)
で決まる，という状況を表している．
この連立微分方程式は，変数消去の方法で解くことができ，
$$
    x_{1} = 4C_{1}e^{2t} + C_{2}e^{3t} \\
    x_{2} = 3C_{1}e^{2t} + C_{2}e^{3t}
$$
となり，各変数の振る舞いを時間の関数として表示できる．

#### 連立1階線形微分方程式
変数を$n$個に増やした場合，ベクトル$\boldsymbol{x}$と行列$A$を用いて，
$$
    \vec{x} = \left(
        \begin{array}{c}
        x_1 \\ 
        x_2 \\
        \vdots \\
        a_n 
        \end{array}
        \right)
$$
$$
    A = \left(
        \begin{array}{cccc}
        a_{11} & a_{12} & \ldots & a_{1n} \\
        a_{21} & a_{22} & \ldots & a_{2n} \\
        \vdots & \vdots & \ddots & \vdots \\
        a_{m1} & a_{m2} & \ldots & a_{mn}
        \end{array}
        \right)
$$

$$
    \frac{d\vec{x}}{dt} = A\vec{x}
$$

この方程式は解くことが出来て，その解は指数を$\lambda t$とする指数関数を含む関数の和で表現される．
この$\lambda$を行列$A$の固有値(eigenvalue)という．

#### 「固有値」の値によって解の性質が決まる
行列$A$の大きさが$n \times n$の時，固有値$\lambda$は$n$個存在する．
この中でも$lambda$の実数部分の値が正の場合は，時間に応じで$\lambda t$は正の値で増大して行くため，最終的に発散する．
一方で負の場合は$0$に収束する．
このように，解が時間経過と共に一定の値の範囲に収束するのか発散するのかを論じる手法は本書でも多く出てくる．
もし$\lambda$の実数部分が$0$の場合は，注意が必要．

---
### 4.2 非線形微分方程式モデル
#### 非線形な項を含む微分方程式
変数やその微分の間の掛け算を式の中にある場合，解析的に解くことはできない．
しかし，微分方程式を解かなくても振る舞いをある程度調べることは可能である．

#### ロトカ・ヴォルテラ方程式
捕食者・被食者の個体数変動をモデル化．
ロトカ・ヴォルテラ方程式(Lotka-Volterra equation)
$$
    \frac{dx}{dt} = x(r - ay) \\
    \frac{dy}{dt} = y(-s + bx)
$$
$x$が被食者の数，$y$が捕食者の数，$a, b, r, s$は正のパラメータ．

#### 「定常」な状態について考える
定常解：時間変化しない状態．
先ほどの方程式に，$0$を代入して，微分を含まない連立方程式を解くと，
$$
    x = 0, y = 0
$$
または
$$
    x = s/b \\
    y = r/a
$$
となり，両者ともに存在しない時か，被食者が自然に増える速さと捕食者に捕食される速さが一致し，かつ捕食者が自然に減っていく速さと捕食によって増えていく速さが一致するというバランスが取れた状態を表現．


#### 定常解の「安定性」
安定性(stability): 微小変化した時に，状態が元の定常解に戻ろうとする時．
逆に，どんどん誤差が拡大していく場合は不安定．

#### 安定性を実際に評価する
ロトカ・ヴォルテラモデルにおいて，被食者と捕食者がいない定常解
$$
    x_{0} = 0, y_{0} = 0
$$
について，微少変化を$\epsilon_{x}, \epsilon_{y}$を与えた時にどうなるかを検討する．
システムの状態$(x, y)$は
$$
    x = x_{0} + \epsilon_{x}, y = y_{0} + \epsilon_{y}
$$
であり，ロトカ・ヴォルテラ方程式に代入して整理すると，
$$
    \frac{d\epsilon_{x}}{dt} = r\epsilon_{x} \\ 
    \frac{d\epsilon_{y}}{dt} = -s\epsilon_{y}
$$
となる．この微分方程式を解くと，
$$
    \epsilon_{x} = C_{1}e^{rt} \\ 
    \epsilon_{y} = C_{2}e^{-st}
$$
となり，$r, s$の正のパラメータであるため，$\epsilon_{x}$は発散する．
よって
$x_{0} = 0, y_{0} = 0$
は安定ではないことがわかる．
被食者は捕食者がいないと増え続けることができ，捕食者は被食者がいないと増えることができない．

#### 微分方程式の線形化による解析
定常状態からの微小誤差についての方程式を作ると，二次以上の非線形な項を無視することができる．
つまり，非線形の項を全て消去することができ，結果的に非線形の微分方程式が線形の方程式になる．
この手続きを**線形化**といい，線形化によって状態の安定性を評価することを
**線形安定性解析**(linear stability analysis)という．

定常解と安定性の議論は，かなり汎用性の高い手法．

#### 数値シミュレーション
直接解けない場合でも数値計算を行うことで，実際にその方程式に従う状態の時間変化を見ることができる．
$$
    \frac{dx}{dt} = x(r - ay) \\ 
    \frac{dy}{dt} = y(-s + bx)
$$
ある時間$t_{0}$における個体数を$x_{0}, y_{0}$とした時，
$x, y$のそれぞれの変化速度$v_x, v_y$は
$$
    v_x = x_{0}(r - ay_{0}) \\ 
    v_y = y_{0}(-s + bx_{0})
$$
と表すことができる．
そこから微小時間経$\Delta{t}$経った時の，それぞれの個体数$\hat{x}, \hat{y}$は
$$
    \hat{x} = x_{0} + v_x\Delta{t} \\ 
    \hat{y} = y_{0} + v_y\Delta{t}
$$
より，
$$
    \hat{x} = x_{0} + x_{0}(r - ay_{0})\Delta{t} \\ 
    \hat{y} = y_{0} + y_{0}(-s + bx_{0})\Delta{t}
$$

と計算することが可能である．

このように$\Delta{t}$をとって値を更新していく方法をオイラー法による数値積分という．
またより誤差を小さくしたルンゲクッタ法(Runge-Kutta method)が実用的に用いられる．

**数理モデリングでは，実際にそのモデルがどのように振る舞うかを調べるのは必須である．**


---
### 4.3 解けるモデル・解けないモデル
#### 解ける微分方程式は少ない
解ける微分方程式の目安  
- 微分方程式が線形である
- 独立変数以外の変数が一つだけの微分方程式なら，多少非線形でも解ける

#### 線形の微分方程式
定数項や高階の微分が含まれていても解ける．

#### 1変数の非線形の微分方程式
- 変数分離形
- 同次形
- ベルヌーイの微分方程式
- ラグランジュの微分方程式

#### 偏微分方程式
別の変数による偏微分を含む微分方程式のこと．
拡散方程式(diffusion equation):
$$
    \frac{\partial C(x, y)}{\partial t} = D \frac{\partial ^2 C(x, t)}{\partial x^2}
$$
$C$は着目している熱や物質の量，$D$は拡散係数を表すパラメータ，$t$は時間，$x$は位置を表す独立変数．

#### 分析ソフトウェアの利用
常微分方程式を解析的に解くソフトウェアも数値シミュレーションをソフトウェアもある．

---

### 4.4 制御理論
#### 入力変数に対してシステムがどう応答するか
- 制御工学(control engineering): 入力及び出力を持つシステムにおいて，その出力を自由に制御する方法全般にか関わる学問．
- 制御理論(control theory): 数理モデルを対象とした，主に数学を用いた制御に関する理論．
    - モデルの表現方法，解析手法(安定性など)，制御形設計方法
- 制御応用: 実モデルに適応していく．


#### 微分方程式を解くための便利な道具
ラプラス変換(Laplace transform): 積分計算することで別の関数に変換する．「関数の微分」を変換することが重要．

#### 微分方程式をラプラス変換で解く
1. 元の微分方程式をラプラス変換する
2. ラプラス変換後の世界で解く
3. 元の世界に戻す

このようにすることで，簡単に微分方程式を解くことが出来る．

#### 微分方程式に制御項を入れてみる
微分方程式に制御できる項$u(t)$をいれて，ラプラス変換を行い，変換すると
$$
X(s) = G(s)U(s)
$$
制御できる変数$u(t)$のラプラス変換$U(s)$は，一つの関数を決めると一つの具体的な関数が入る．
$G(s)$を伝達函数という．ここに，システムの安定性情報が含まれていて，これを分析することで色々分かる

#### 目的の値を達成するためのフィードバック系を考える
PID制御(Proportional-Integral-Differential Controller)

目標値を目指して制御している時に，ある時刻における目標値からのずれを0に近づけるために，3つの要素に従って入力の値を決める．

- 比例要素(P): 現在のずれに比例した値を入力に加える
- 積分要素(I): 今までのずれを時間的に積分し，それに比例した値を入力に加える
- 微分要素(D): ずれの変化速度に比例した値を入力に加える

比較的実装しやすく，パラメータの値を適切に設定すると非常によく機能する．

#### 古典制御理論と現代制御理論，その後
ラプラス変換や伝達関数は古典制御理論という．
それ以降は，観測できない変数(状態変数)や多変数のダイナミクスを考慮にいれることが可能な現代制御理論につながっている．

---
### 第4章のまとめ
- 変数の変化の速度を表す微分を含む式を微分方程式といい，変数の動的な振る舞いを理解するのに使用される
- 線形の微分方程式では，変数の時間変化を時間の関数で表示することができるが，非線形の方程式の場合解けないことが多い
- 解けない微分方程式でも，定常状態が維持されやすいかどうかを安定性の議論によって調べることが出来る
- 線形の微分方程式の場合，変数の値をコントロールする制御理論が整備されている

---
---
## 第5章 確率モデル
### 5.1 確率過程
#### 確率的な状況を考える
微分方程式は同じ条件からスタートした場合，毎回同じなる(決定論的なダイナミクス)．
現実のデータはばらつきがあり，それが無視できない場合は，確率的な要素をもつモデルの方が対象の実態をよく捉えることが出来る．

#### 確率分布は確率の情報をひとまとめにしたもの
確率分布(probability distribution): 確率変数がとる値ごとに，それが実現する確率をひとまとめにした関数．
確率変数(random variable): 実際に出る値．

#### 連続変数の確率分布
単独の値が起こる確率は0だが，幅を持たせることで0でない値を定義できる．

#### 連続変数の確率分布: 確率密度関数
確率密度関数(probability density function): 簡単にいうと確率分布のこと．
確率変数$X$が，$a$から$b$に入る確率は確率密度関数$p(x)$を用いて，以下の式で表すことができる．
$$
P(a \leq X \leq b) = \int_{a}^{b}p(x)dx
$$

ヒストグラムをどんどん小さくしていくと確率密度関数が出来上がるイメージ．

#### 何度もサイコロを振ってみる
確率過程(stochastic process): 時間変化していく確率変数のこと


---
### 5.2 マルコフ過程
#### マルコフ過程は，過去の状態を振り返らない
マルコフ過程(Markov process): システムの確率変数(状態)を変化させる時に，現在の状態の情報だけで次の状態を決めること

#### ランチの決め方
今日食べたランチによって，次の日に食べるランチを決める．

マルコフ過程において，離散的に時間が進む場合を，特にマルコフ連鎖(Markov chain)という．

#### どれくらいの割合でラーメンを食べることになるか
日々のランチが，確率的にきまっていくが，この状態が変化していくことを状態遷移(state transition)といい，
それぞれの状態遷移が起こる確率を遷移確率(transition probability)という．

#### 状態確率の方程式を立てる
状態確率: ある時間でのそれぞれの確率変数が起こる確率

$$
(次の状態確率) = (状態遷移行列) \times (前の状態確率)
$$

前の状態確率に行列を掛け算すると次の状態確率が出てくる．
ある時刻における状態は，初期条件の状態確立に遷移行列を$t$回掛け算することで求めることが出来る．

#### 時間が十分経過した後の話
ある一定の条件を満たせば，状態確率は時間変化しない一定の値に収束する．この状態を定常状態という．
定常状態を考えると，簡単に確率や期待値を計算することができ，システムの分析に役立つ．


---
### 5.3 待ち行列理論
#### 窓口の行列を確率的に表現する
あるコンビニにATMを設置したいが，一台で足りるか？

これを数理モデルを使って評価する

#### 平均的な振る舞いに基づいた推測
最も簡単なアプローチは平均的にどれくらいの利用者がやってきて，そして平均的に一回の利用でどれくらいの時間ATMを占有するかを調べること．
新しい利用者が到着するまでの時間が一人当たりの利用時間より長ければ大丈夫そう．

しかし，この推論には問題がある．それは利用者がやってくるタイミングや利用時間が一定ではなく，人によってばらついていることを考慮できていない．

#### ランダムに利用者が到着することを表現するポワソン過程
ATMに利用者が到着する頻度を1時間あたり$\lambda$とする．これはまだ，実際にどのタイミングで利用者がやってくるかはわからない．

この時に，最もランダムな到着の仕方として，次のように考える．

微小時間$\Delta t$で1時間を分割すると考えて，そのそれぞれの時点で確率$\lambda \Delta t$でランダムに利用客が到着すると考える．

このようにして得られた事象を時間に従ってカウントしていく確率過程をポワソン過程(poisson process)という．

#### 増えたり減ったりを表現する出生死滅過程
これまでに利用者が到着する様子をモデル化することができた．次に，利用者が利用していなくなる要素を含める．

利用者がいる時に，サービスが完了する速さを$\mu$とする．
ポワソン過程では，微小時間$\Delta t$の間に確率$\lambda \Delta t$でATMの列に新しい利用者がやってくるが，
さらに，確率$\mu \Delta t$で列のATMの先頭にいる利用者がいなくなる確率過程を考える．
これを**出生死滅過程**(birth-death process)という．

#### 行列の長さを確率的に捉える
出生死滅過程によって，行列の長さが確率的に変化する様子を分析する．
人数がランダムに増減するので，人数を直接扱うのは難しい．
そこで，時刻$t$に行列が$n$人である確率$P_{n}(t)$を導入して，計算する．
行列に並んでいる人数$n$人のパターンは無数にあるが，どれも同じ構造なので，一般に$n$人の時だけを調べる．

$$
P_{n}(t+\Delta t) = \lambda P_{n-1}(t)\Delta t + (1 - \lambda \Delta t \mu \Delta t)P_{n}(t) + \mu P_{n+1}(t)\Delta t
$$
左辺第1項は新しく到着した場合，第2項は増減なし，第3項は完了して減った場合．

$\Delta t$が非常に小さい極限をとると，微分方程式として，表現出来る．
$n$が無数にある線形の微分方程式であり，時間の関数として解けない．
この方程式が時間の経過によって定常解に近づくのでその定常的な振る舞いを考える．

#### 定常状態の分析
時間に関係なく$P_{n}(t)$は変化しなくなる(微分=0)．三項漸化式や無限等比級数を解いていくと，
$$
P_{n} = (1-\rho)\rho^n
ただし，\rho = \lamda / \mu
$$

#### 確率分布がわかったら，期待値がもとまる
確率分布がわかれば，たいていの期待値(e.g. ATMの稼働率，平均の行列の長さなど)を求めることが可能．

#### 確率モデルの強みと限界
確率過程を数理構造にもつモデルは，
**システムにおけるばらつきの効果が無視できない場合に，直感的には予測が難しい性質を捉えることが出来る．**

気をつけるべきこととして，このモデルで仮定した出生死滅過程が，現実のシステムと必ずしも精度良く一致しているとは限らないこと．
例えば，利用者の到着などを決める確率分布は常に一定ではなく，時間によって変化するかもしれないし，ATMを2台設置した場合を考えたいかもしれない．

このような家庭のうち，特に数理的な解析の難易度を大きく変えるのは確率過程の選択である．
過去の状態を含めないマルコフ過程は，数理的に解析しやすいが，それ以外の確率過程は非常に難しくなる．

#### 数値的な解析は比較的容易
モンテカルロ・シミュレーション(Monte Carlo simulation):確率モデルの振る舞いをコンピュータでシミュレートする際に，プログラムに乱数を発生させて，それに従って実際にモデルを動かすこと．

#### マルコフ近似
マルコフ性を満たさなくても，マルコフ性を満たすとして計算し，その後整合性をチェックする方法がある．

---
### 第5章のまとめ
- 変数の振る舞いを確率的に記述したものを確率モデルという
- 変数の確率的な振る舞いが，一つ前の時点の状態のみに依存するものをマルコフ過程といい，理論解析のしやすさからよく使用される
- システムが十分時間が経った後に達する定常状態は，理論的な解析が容易に出来る
- システムの状態の確率分布が求まれば，そこからさまざまな量の期待値を計算することが出来る


---
---
## 第6章 統計モデル
### 6.1 正規分布
#### 双六の結果
サイコロを一回振った時の目の出方は一様分布(uniform distribution)，
サイコロを何回か連続で振った場合は真ん中が高くなるようになる．

#### 正規分布は確率分布の親玉
このようにサイコロを何回も振ってその和をとっていくと，確率分布は正規分布(normal distribution)に近づく．
これを中心極限定理(central limit theoram)という．
つまり，一般的な確率分布から独立に生成された確率変数を足していけば，その和の確率分布は正規分布に近づく

#### 正規分布の定義
二つのパラメータ: 平均(mean)と標準偏差(standard deviation)で表現され，
$N(\mu, \sigma ^2)$と書く．

#### 異なる正規分布同士の足し算も正規分布
異なる正規分布から生成される確率変数の足し算は，それぞれの平均と分散を足した確率分布の従う．

#### 正規分布の二乗の足し算は?
世紀分布から生成される確率変数を二乗したものの和は，$\chi ^2$分布に従う．
$\chi ^2$分布に従う確率変数の比をとると，$F$分布に従う．

---
### 6.2 統計的検定
#### ばらつきについて考える
得られるデータは常にばらつき・誤差を含んでいる．
このばらつきが発生する確率に焦点をあてることで，データに見られる特徴が偶然起きたのか，それとも何らかの意味があるのかを評価出来る．

#### 偶然の確率
コインを10回投げて，表が9回出た．
これは偶然なのか，コインに仕掛けがあって表がでやすくなっているのか？

- 帰無仮説(null hypothesis): 検定を行うために立てる仮説
- 対立仮説(alternative hypothesis): 帰無仮説に相対する仮説
- p値: 帰無仮説を仮定した時に，今回得られたデータが発生する確率
- 有意水準(signigicance level): 有意か否かを判定する基準．

#### 平均に関する検定
今得られた$n$個のデータが独立に正規分布から生成されたとする(数理モデルを仮定している)．
この時，このデータが従っている真の確率分布の平均値は$\mu$と異なっているか？を検定したい．
なお，真の確率分布の分散$\sigma ^2$が分かっているとする．

この時，標本平均を$\bar{X}$として，次の値を計算する．
$$
Z = \dfarc{\bar{X} - \mu}{\sigma / \sqrt{n}}
$$
この$Z$は，帰無仮説が正しければ，標準正規分布に従うとされ，そこからこのずれが発生する確率を評価することが出来る．

検定に使用する量のことを検定統計量(test statistics)といい，統計検定ではこの検定統計量が特定の確率分布に従うことを利用して，
そのような値が実現する確率を求める．
またデータの真の分布として正規分布などを仮定できない場合は，ノンパラメトリック検定が利用される．

#### 統計検定は万能ではない
統計検定は「帰無仮説の上でデータの事象が偶然起きるにしては確率が低すぎる」と言っているだけ．

帰無仮説が棄却されなかった場合は，帰無仮説が正しいと示したわけではなく，帰無仮説では説明できない，と言っているだけ．

有意水準が0.05と言っても，20回に1回は偶然起こりうることに注意が必要(検定を何度も行うと有意になることがある: 多重生の問題)

#### 第一種過誤と第二種過誤
- 第一種過誤(type 1 error): 本当は帰無仮説が正しいのに，誤って帰無仮説を棄却してしまうこと．有意水準
- 第二種過誤(type 2 error): 本当は対立仮説が正しいのに，誤って帰無仮説を採択すること．検出力．

統計検定ではこの二つを同時に小さくすることはできない．

#### 統計検定の実施
Rm Python, Excel, HAD, SPSS, JPMなど


---
### 6.3 回帰分析
#### 線形モデルの妥当性
統計モデルの視点から見る

#### 同じ線形モデルでも・・・
別々に得られたデータ(データ1, データ2)において，最小二乗法を用いて，線形モデルを作成した．
この時，全く同じ関係式が得られた．
しかしながら，データ1の方が散らばりが少なく，よく説明できてる．

この時，線形モデルの当てはまりの良さを表す指標として，決定係数(coefficient of determination)がある．
これは，モデルと測定値の誤差と全体のばらつきの比率を求め，そこから，線形モデルがどれだけ良く当てはまっているかを見ることが出来る．

#### ピアソン相関係数による評価
ピアソン相関係数(Pearson's correlation coefficient): 二つの変数の連動性を定量化した指標．
あくまでも線形の関係でデータがどれだけ説明できるかを示している．

#### 当てはまりの良さだけで結論していい?
線形回帰を決定係数や相関係数などの当てはまりの良さだけで評価してはいけない，

相関係数$r$に基づいて，行う方法と回帰係数$\beta$に基づいて行う方法がある，

線形回帰した式とそれぞれのデータ点をの誤差が同一の世紀分布からランダムに発生していると仮定する．
その上で相関係数が$r=0$，もしくは，回帰係数$\beta = 0$を帰無仮説に設定する．
そして検定を行う．

#### 変数の数が増えた場合は重回帰分析
説明変数が複数ある場合は重回帰分析になる

#### 線形でないモデル
線形モデルは

- 変数の間の関係が線形(直線)の関係式で表現できる
- 誤差が常に同じ正規分布に従う
という強い仮定をおいている，

このような仮定が成立しない時は，一般化線形モデル(generalized linear model)を利用すると良い．

---
### 第6章のまとめ
- 正規分布は確率分布の親玉的な存在で，様々なところで利用されている
- 仮定した確率モデルを使って，データの背後にある真の分布に関する推論を行う手続きのことを，統計的検定という
- 線形モデルの妥当性を統計的検定によって評価することができる
- 一般化線形モデルを使えば，モデルの非線形性やばらつきの分布を自由に選択できる

---
## 第二部のまとめ
方程式モデル，微分方程式モデル，確率モデル，統計モデルについての基礎事項を学んだ．
最適化，微分方程式，安定性，確率過程，定常状態の解析，統計的検定はより高度なモデルでも使われる．






