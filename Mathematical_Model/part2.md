# 第二部 基礎的な数理モデル
## 第3章 少数の方程式によるモデル
### 3.1 線形モデル

#### 変数間の関係を等式で表現する
数学的に扱いやすく，変数同士の関係や影響の度合いを分析することが可能

#### 線形モデル
線形モデル(linear model): 線型結合(加減・定数倍)で表すことができるモデル．

### 線形モデルを求めるには
パラメータの値をデータに最も当てはまるようにしたい

### 最小二乗法
最小二乗法(least squares method): 二乗誤差を最小にするパラメータを推定する．
詳細な計算は省くが，偏微分することで求まる．

多重共線性: 説明変数にうち，お互いに関与しあっていること．どっちのパラメータを重視して良いか分からなくなり，結果が不安定になる．


---
### 3.2 実験式・カーブフィッティング
#### BMIと数理モデル
$$
    体重[kg] = (定数) \times 身長^2 [m^2]
$$

#### 冪乗による特徴づけ
冪乗則(power law), スケーリング(scaling): ある変数の値が別の変数の値の何乗かに比例する．
この指数を決めているメカニズムを知ることで，本質的なことがわかる場合がある

### 対数プロットで冪乗則を探す
$$
    Y = cX^\alpha
    log{Y} = \alpha log{X} + log{a}
$$
対数グラフの傾きを見ることで，$\alpha$を決めることができる．
しかしあんがら，データの和也変数の範囲が不十分だと誤った結果を導くことが多い

### 実験式
実験式(experimental formula): データの振る舞いに合わせて，関数を設定する．
データの可視化を通して組み立て，データと式の誤差からパラメータを計算する．
これには多項式や指数関数，三角関数などが用いられることが多い．


### 3.3 最適化問題
#### 目的の量をコントロールする
最適化問題(optimization problem): 変数を適切に設定して，ある量を最小化・最大化すること．

目的関数(objective function): 最適化問題を行う関数．

#### 大域的最適と局所的最適
局所的最適解(local optimal solution): 周囲よりも小さい・大きい点．

大域的最適解(global optimal solution): 全体で最も小さい・大きい点．

最適化問題が難しくなると，大域最適解を求めるのは難しくなる．様々なアルゴリズムが開発され，計算されている．

#### パラメータ調整も最適化
数理モデルのパラメータを設定するのは，データとモデルの間の誤差を目的関数として最小化するという最適化問題．最適化問題

#### 最適化を難しくする要素
- 変数の制約条件が多い
- 変数が離散的
- グラフやネットワークに関する最適化が含まれている
- 組合せに関する問題が含まれている(組合せ最適化問題)
- 変数の数や，離散変数のとりうる値の場合の数が多い
- 問題に微分不可能な関数や不連続な関数が含まれている

これらの要因により，以下の次のような状況が発生し，困難になる．

- 探索空間が膨大になる
- 微分や変数を少しずつ変化させて解を探す方法が使えないので，解の候補を探すのが大変になる
- 大域的最適解と比べて良くない局所解がたくさんある

---
### 第3章のまとめ
- 変数間の関係性を，変数の定数倍とそれらの加減で記述したモデルを線形モデルという．
- 変数の間の関係性が冪乗で表されるとき，それを冪乗則という．
- モデルの式から予測される値と実際の値の差を二乗して平均をとったものを平均二乗誤差といい，これを最小化することでパラメータの値を決めることを最小二乗法という．
- 変数の値をコントロールして別のある変数の値を最小化・最大化する問題を，最適化問題という．


---
## 第4章 少数の微分方程式によるモデル
### 4.1 解ける微分方程式モデル
#### 微分方程式で時間変化を表す
対象の時間変化をボトムアップ的にモデル化したい→微分方程式によるモデリング．  
微分方程式によるモデリングは，家庭から演繹的にモデルを構成することが多い．

力学系(dynamical system): 変数の時間変化を直接記述したモデル

#### マルサスによる個体数モデル
個体数がどのように増えるかをモデル化した．
個体数を$N$，時間を表す変数を$t$とした時，個体が増える速さは$\frac{dN}{dt}$と，$N$の微分で表すことができる．
マルサスは『人口論』において，「この速度はその時点の個体数に比例する」と考えて，
$$
    \frac{dN}{dt} = rN
$$
を，個体数の増加モデルを作成した．$r$は個体が増殖する速さを表すパラメータである．

#### マルサスモデルの解の振る舞い
マルサスモデルを解くと，その解は
$$
    N(t) = N_{0} e^{rt}
$$
と求めることができる．$N_{0}$は最初の時点における個体数．
グラフを書くと分かるが，個体数は時間と共に爆発することがわかる．

#### 個体数は，爆発的に増え続けたりしない
実際には個体数は増え続けない→モデル化が間違っている．
資源は有限なので，個体数が増えすぎた場合は，個体数が減る方向に動くはず．
この効果を含めたのが**ロジスティック回帰(logistic regression)**である．
個体数増加の速度が．個体数によって変動することを加えた，以下のようなモデルである．
$$
    \frac{dN}{dt} = r(1 - \frac{N}{K})N
$$
ここで，$K$は環境収容力というパラメータ．この微分方程式を解くと，
$$
    N(t) = \frac{N_{0}Ke^{rt}}{K - N_{0} + N_{0}e^{rt}}
$$
と求まり，これをロジスティック関数(logistic function)という．

このようにして，生物の個体数変動をボトムアップ的に仮定した方程式によってモデル化することが出来た．
実際に，いくつかの生物種ではこのモデルに合致することが知られている．

#### 簡単な連立微分方程式
一般的に変数が増えると，微分方程式を解くのは非常に難しくなる．
しかし，連立微分方程式なら，変数が増えても解ける場合がある．


#### 2本の連立微分方程式































